<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chismes â€” Neon</title>

<style>
  :root{
    --bg:#0d0f15;
    --card-bg: linear-gradient(circle at top left, #1a1c25 0%, #0c0d12 100%);
    --neon-pink: #ff2ea6;
    --neon-purple: #b832ff;
    --accent: #ff2c7d;
    --muted:#d8d8e0;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    background:var(--bg);
    color:var(--muted);
    font-family:Inter, "Segoe UI", Arial, sans-serif;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding-bottom:40px;
  }

  h1{
    text-align:center;
    color:var(--neon-pink);
    text-shadow:0 0 10px var(--neon-pink);
    margin:20px 0 8px;
    font-weight:600;
  }
  h2{
    text-align:center;
    color:var(--neon-purple);
    margin:8px 0 18px;
    font-weight:500;
  }

  /* FORM */
  .chisme-form{
    width:95%;
    max-width:1200px;
    margin: 0 auto 22px;
    display:flex;
    gap:12px;
    padding:14px;
    background:#0f1116;
    border-top:3px solid var(--accent);
    border-radius:12px;
    align-items:center;
    flex-wrap:wrap;
  }
  .input-box{
    padding:10px;
    border-radius:10px;
    background:#0b0d12;
    border:1px solid rgba(123,44,191,0.25);
    color:white;
  }
  .xat-input{ width:170px; min-width:120px; }
  .chisme-input{ flex:1; min-width:260px; height:110px; resize:vertical; font-size:15px; }
  .add-screenshot{ width:40px; height:40px; border-radius:8px; border:none; background:var(--accent); color:#fff; font-size:22px; cursor:pointer; }
  .add-btn{ padding:10px 18px; background:var(--accent); border:none; border-radius:10px; color:white; cursor:pointer; font-weight:700; }

  /* WRAPPER */
  .chismes-wrapper{
    width:95%;
    max-width:1200px;
    margin: 10px auto 40px;
    padding:20px;
    background:var(--card-bg);
    border:3px solid var(--neon-pink);
    border-radius:18px;
    box-shadow: 0 0 25px var(--neon-pink), inset 0 0 15px #b832ff55;
    max-height:520px;
    overflow-y:auto;
  }
  .chismes-wrapper::-webkit-scrollbar{ width:10px }
  .chismes-wrapper::-webkit-scrollbar-thumb{ background:var(--neon-pink); border-radius:10px }

  #listaChismes{ display:flex; flex-direction:column; gap:12px; padding-right:8px; }

  /* CARD */
  .chisme-card{
    display:flex;
    align-items:center;
    gap:18px;
    background:var(--card-bg);
    border:3px solid var(--neon-pink);
    border-radius:18px;
    box-shadow: 0 0 15px var(--neon-pink), inset 0 0 10px #b832ff55;
    padding:16px;
    transition:transform .18s ease, box-shadow .18s ease;
  }
  .chisme-card:hover{ transform:scale(1.02); box-shadow:0 0 28px var(--neon-pink), inset 0 0 15px #b832ff88; }

  .chisme-icon{
    width:84px; height:84px; border-radius:50%;
    background:linear-gradient(145deg,var(--neon-pink),var(--neon-purple));
    display:flex; align-items:center; justify-content:center;
    font-size:38px; color:white;
    box-shadow:0 0 18px var(--neon-pink), inset 0 0 10px #ffffff33;
    flex-shrink:0;
  }

  .chisme-texto{ flex:1; font-size:15px; color:var(--muted); line-height:1.5; word-break:break-word; }
  .chisme-texto strong{ color:var(--neon-pink); font-size:15.5px; display:block; margin-bottom:4px; }

  .btn-ver{
    background:transparent;
    border:3px solid var(--neon-purple);
    color:var(--neon-purple);
    padding:12px 20px;
    border-radius:14px;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 0 10px #b832ff55;
    transition:transform .14s ease, background .14s ease, color .14s ease;
  }
  .btn-ver:hover{ background:var(--neon-purple); color:#fff; transform:scale(1.04); box-shadow:0 0 22px var(--neon-purple) }

  /* MODAL */
  .modal-bg{
    position:fixed; inset:0;
    display:none;
    background:rgba(0,0,0,0.6);
    justify-content:center; align-items:center;
    padding:20px;
    z-index:999;
  }
  .modal{
    width:92%;
    max-width:720px;
    background:#0e0f14;
    border-radius:14px;
    padding:18px;
    border:1px solid var(--accent);
    box-shadow:0 0 32px #ff2c7d;
    max-height:85vh;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .modal-top{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
  .modal h3{ margin:0; color:var(--neon-pink); text-shadow:0 0 8px var(--neon-pink) }
  .close-modal{ cursor:pointer; color:var(--accent); font-size:22px; border:none; background:transparent; }

  /* modal content area (scroll) */
  .modal-body{
    overflow-y:auto;
    padding-right:8px;
    max-height:60vh; /* enough for long text + captures */
  }
  .modal-body::-webkit-scrollbar{ width:10px }
  .modal-body::-webkit-scrollbar-thumb{ background:var(--neon-purple); border-radius:10px }

  #modal-chisme{
    white-space:pre-wrap; /* preserve line breaks */
    color:var(--muted);
    font-size:15px;
    line-height:1.6;
    margin-bottom:10px;
  }

  /* CAPTURAS: each link stacked vertically and neon style */
  #modal-capturas{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-top:6px;
  }
  #modal-capturas a{
    display:block;
    text-decoration:none;
    padding:10px 12px;
    border-radius:10px;
    border:2px solid rgba(184,50,255,0.18);
    background:linear-gradient(90deg, rgba(255,46,166,0.03), rgba(184,50,255,0.02));
    color:var(--neon-pink);
    font-weight:700;
    box-shadow:0 0 10px rgba(184,50,255,0.06);
    word-break:break-word;
  }
  #modal-capturas a:hover{
    transform:translateY(-2px);
    box-shadow:0 6px 20px rgba(184,50,255,0.14);
  }

  /* responsive tweaks */
  @media (max-width:700px){
    .chisme-icon{ width:64px; height:64px; font-size:30px }
    .btn-ver{ padding:10px 14px; font-size:14px }
    .chisme-input{ height:90px }
  }
</style>
</head>
<body>

  <h1>ðŸ˜±ðŸ”¥ Chisme del DÃ­a</h1>
  <h2>Â¡Todo neon y bonito!</h2>

  <div id="chismeDiaContainer" style="width:95%;max-width:1200px;margin:0 auto 12px;"></div>

  <h2 style="margin-top:2px;color:var(--neon-pink)">ðŸ“š Chismes Antiguos</h2>
  <div class="chismes-wrapper">
    <div id="listaChismes"></div>
  </div>

  <!-- FORM -->
  <div class="chisme-form" role="form" aria-label="Form para chismes">
    <input class="input-box xat-input" id="xat" placeholder="Â¿Chisme de cuÃ¡l xat?" />
    <textarea class="input-box chisme-input" id="chisme" placeholder="Escribe tu chisme..."></textarea>

    <div id="capturas-container" style="display:flex; gap:10px; flex-wrap:wrap;"></div>

    <button class="add-screenshot" id="add-cap" title="AÃ±adir campo de captura">+</button>
    <button class="add-btn" id="add" title="AÃ±adir chisme">AÃ±adir Chisme</button>
  </div>

  <!-- MODAL -->
  <div class="modal-bg" id="modal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-xat">
      <div class="modal-top">
        <h3 id="modal-xat"></h3>
        <button class="close-modal" id="closeBtn" aria-label="Cerrar modal">Ã—</button>
      </div>
      <div class="modal-body">
        <div id="modal-chisme"></div>
        <div id="modal-capturas"></div>
      </div>
    </div>
  </div>

<script>
/* ===== util: extrai urls do texto (funciona quando vÃ¡rios links estÃ£o na mesma linha separados por espaÃ§os) ===== */
function extractUrls(text){
  if(!text) return [];
  // regex simples para detectar http/https links
  const urlRegex = /https?:\/\/[^\s]+/g;
  const matches = text.match(urlRegex);
  return matches ? matches.map(s => s.trim()) : [];
}

/* ===== elementos ===== */
const lista = document.getElementById('listaChismes');
const chismeDiaContainer = document.getElementById('chismeDiaContainer');
const capturasContainer = document.getElementById('capturas-container');

function createCaptureInput(value=''){
  const wrapper = document.createElement('div');
  wrapper.style.display = 'flex';
  wrapper.style.gap = '6px';
  wrapper.style.alignItems = 'center';

  const input = document.createElement('input');
  input.className = 'input-box url-input';
  input.placeholder = 'URL de captura (opcional)';
  input.value = value;

  const btn = document.createElement('button');
  btn.type = 'button';
  btn.className = 'remove-cap';
  btn.textContent = 'âˆ’';
  btn.onclick = () => wrapper.remove();

  wrapper.appendChild(input);
  wrapper.appendChild(btn);
  capturasContainer.appendChild(wrapper);
  return input;
}

/* start com um campo */
createCaptureInput();
document.getElementById('add-cap').onclick = () => createCaptureInput();

/* ===== modal open/close ===== */
const modalBg = document.getElementById('modal');
const modalXat = document.getElementById('modal-xat');
const modalChisme = document.getElementById('modal-chisme');
const modalCapturas = document.getElementById('modal-capturas');
document.getElementById('closeBtn').onclick = closeModal;

function openModal(xat, chismeText, captures){
  modalXat.textContent = xat ? `Xat: ${xat}` : 'Xat: Desconocido';
  modalChisme.textContent = chismeText || '';

  // limpa area de capturas
  modalCapturas.innerHTML = '';

  // Se capturas jÃ¡ vierem como array, use; se nÃ£o, extrai do texto tambÃ©m
  let urls = Array.isArray(captures) ? captures.slice() : [];
  // tambÃ©m extraÃ­mos urls do texto (cobre o caso links inline)
  urls = urls.concat(extractUrls(chismeText));
  // dedup e filter
  urls = Array.from(new Set(urls.filter(u => !!u)));

  if(urls.length === 0){
    const no = document.createElement('div');
    no.innerHTML = "<em style='color:var(--accent)'>Sin capturas</em>";
    modalCapturas.appendChild(no);
  } else {
    // cada link em uma linha â€” estilizado
    urls.forEach(u => {
      const a = document.createElement('a');
      a.href = u;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      a.textContent = u;
      modalCapturas.appendChild(a);
    });
  }

  modalBg.style.display = 'flex';
  modalBg.setAttribute('aria-hidden','false');
}

/* fechar ao clicar fora do modal interno */
modalBg.addEventListener('click', (e) => {
  if(e.target === modalBg) closeModal();
});
function closeModal(){
  modalBg.style.display = 'none';
  modalBg.setAttribute('aria-hidden','true');
}

/* fechar com ESC */
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape' && modalBg.style.display === 'flex') closeModal();
});

/* ===== adicionar chisme (cria card) ===== */
document.getElementById('add').onclick = () => {
  const xat = document.getElementById('xat').value.trim() || 'Xat desconocido';
  const chismeText = document.getElementById('chisme').value.trim();

  if(!chismeText){
    alert('Escribe un chisme.');
    return;
  }

  // capturas manuais (campos do form)
  const manualCapturas = [...capturasContainer.querySelectorAll('input')]
    .map(i => i.value.trim())
    .filter(v => v.length>0);

  // cria card
  const card = document.createElement('div');
  card.className = 'chisme-card';

  // icone por default (poderia usar categorias se quiser)
  const icon = 'ðŸ’¬';

  // gerar um preview curto para o card (mostra trecho + se houver links, dÃ¡ um aviso)
  const detectedLinks = extractUrls(chismeText);
  let previewText = chismeText.length > 120 ? chismeText.slice(0,120) + 'â€¦' : chismeText;
  if(detectedLinks.length > 0 && previewText.indexOf(detectedLinks[0]) === -1){
    // se os links nÃ£o aparecem no preview (cortado), nÃ£o precisamos alterar; apenas informaÃ§Ã£o visual mantida no modal
  }

  card.innerHTML = `
    <div class="chisme-icon">${icon}</div>
    <div class="chisme-texto">
      <strong>${escapeHtml(xat)}</strong>
      <div>${escapeHtml(previewText)}</div>
    </div>
    <button class="btn-ver">Visualizar</button>
  `;

  // abrir modal completo ao clicar
  card.querySelector('.btn-ver').onclick = () => openModal(xat, chismeText, manualCapturas);

  // adiciona ao topo da lista
  lista.prepend(card);

  // tambÃ©m define como chisme do dia (substitui)
  chismeDiaContainer.innerHTML = '';
  const cardClone = card.cloneNode(true);
  // adaptamos botÃ£o do clone pra abrir modal com os mesmos dados
  cardClone.querySelector('.btn-ver').onclick = () => openModal(xat, chismeText, manualCapturas);
  chismeDiaContainer.appendChild(cardClone);

  // limpa inputs
  document.getElementById('xat').value = '';
  document.getElementById('chisme').value = '';
  capturasContainer.innerHTML = '';
  createCaptureInput();
};

/* ===== small helper: escapeHtml para seguranÃ§a ===== */
function escapeHtml(str){
  if(!str) return '';
  return String(str)
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'",'&#039;');
}
</script>

</body>
</html>
